*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.21" SourceFile="foxref.vcx" CPID="1252" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS canimation AS olecontrol 
 	*< CLASSDATA: Baseclass="olecontrol" Timestamp="" Scale="Pixels" Uniqueid="" Nombre="canimation" Parent="" ObjName="canimation" OLEObject="E:\WINNT\System32\Mscomct2.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPBra0QYtMEBAwAAAAABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAA/v///wIAAAD+/////v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8V552wwYfREYvjAAD4dU2hIUM0EggAAAD/BQAA3AQAAOCFgxsAAAYAOgAAAC8AAAAPAACAIEM0EmgRAQAAAAAAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2NTFBODk0MC04N0M1LTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAqnUBAAAAAACUIwAAAAAAAK4iAAAAAAAAig8BAAAAAAABAACAAAAAADQeAQAAAAAAqjkAAAAAAAACIAEAAAAAABwfAQAAAAAA8CABAAAAAADcIQEAAAAAAEASAQAAAAAAwCIBAAAAAACaIwEAAAAAAB4lAQAAAAAAyIQAAAAAAABuhgAAAAAAADaHAAAAAAAACIgAAAAAAADUiAAAAAAAAJKFAAAAAAAALhMBAAAAAAAYJwEAAAAAAGieAAAAAAAAJp8AAAAAAADknwAAAAAAAKygAAAAAAAAZKEAAAAAAAAcogAAAAAAANSiAAAAAAAAkKMAAAAAAABQpAAAAAAAABalAAAAAAAA1qUAAAAAAACYpgAAAAAAAFanAAAAAAAAEqgAAAAAAABmtQAAAAAAAFy0AAAAAAAAlioBAAAAAAC6FQEAAAAAAJoWAQAAAAAAmDAAAAAAAAAsvQAAAAAAAA==" />

	*<DefinedPropArrayMethod>
		*m: load
		*m: pause
		*p: cautoloadanimation
		*p: lautoplay
	*</DefinedPropArrayMethod>

	*<PropValue>
		cautoloadanimation = 
		Height = 47
		lautoplay = .T.
		Name = "canimation"
		Width = 58
	*</PropValue>
	
	PROCEDURE load
		LPARAMETERS cAnimationFile
		
		*- This method is designed to allow the laoding of a specified animation file
		*- through a common interface
		*-
		*- By passing lcAnimationFile, we can load the file to be played.
		
		** We make a sure this method is being used as it was intended
		If VARTYPE(m.cAnimationFile) <> 'C'
			ASSERT .F. MESSAGE "cAnimationFile needs to be of type character and is not optional."
		ELSE
			** We check to make sure the file exists
			IF FILE(m.cAnimationFile)
				** We open the animation file
				THIS.Open(m.cAnimationFile)
				
				** We check to see if we need to automatically play the animation or not
				IF THIS.lAutoPlay
					** We play the animation
					THIS.Play()
				ENDIF
			ENDIF
		ENDIF
	ENDPROC

	PROCEDURE pause
		*- This method is designed to allow the pausing of the currently
		*- running animation file through a common interface
		
		** We give the illusion that the animation has been paused
		** by calling the stop method
		THIS.Stop()
	ENDPROC

ENDDEFINE

DEFINE CLASS cgotodefgrid AS cfoxgrid OF "foxctrls.vcx" 
 	*< CLASSDATA: Baseclass="grid" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="colFilename.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colFilename.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colClassMethod.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colClassMethod.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colCode.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colCode.Text1" UniqueID="" Timestamp="" />

	*<PropValue>
		AllowHeaderSizing = .F.
		AllowRowSizing = .F.
		BackColor = 255,255,255
		ColumnCount = 3
		DeleteMark = .F.
		FontName = "Tahoma"
		FontSize = 8
		ForeColor = 0,0,0
		GridLineColor = 192,192,192
		GridLines = 0
		GridLineWidth = 1
		HeaderHeight = 18
		Height = 288
		Name = "cgotodefgrid"
		Panel = 1
		ReadOnly = .T.
		RecordMark = .F.
		RecordSource = "SymbolCursor"
		RowHeight = 18
		ScrollBars = 3
		SplitBar = .F.
		Width = 545
		Column1.Alignment = 0
		Column1.BackColor = 255,255,255
		Column1.ColumnOrder = 1
		Column1.ControlSource = ""
		Column1.DynamicBackColor = ""
		Column1.FontBold = .F.
		Column1.FontName = "Tahoma"
		Column1.FontSize = 8
		Column1.ForeColor = 0,0,0
		Column1.Name = "colFilename"
		Column1.ReadOnly = .T.
		Column1.Width = 237
		Column2.Alignment = 0
		Column2.BackColor = 255,255,255
		Column2.ColumnOrder = 2
		Column2.ControlSource = ""
		Column2.DynamicBackColor = ""
		Column2.FontBold = .F.
		Column2.FontName = "Tahoma"
		Column2.FontSize = 8
		Column2.ForeColor = 0,0,0
		Column2.Name = "colClassMethod"
		Column2.ReadOnly = .T.
		Column2.Width = 182
		Column3.Alignment = 0
		Column3.BackColor = 255,255,255
		Column3.ColumnOrder = 3
		Column3.ControlSource = ""
		Column3.DynamicBackColor = ""
		Column3.FontBold = .F.
		Column3.FontName = "Tahoma"
		Column3.FontSize = 8
		Column3.ForeColor = 0,0,0
		Column3.Name = "colCode"
		Column3.ReadOnly = .T.
		Column3.Width = 600
	*</PropValue>

	ADD OBJECT 'colClassMethod.Header1' AS header WITH ;
		Alignment = 0, ;
		Caption = "Class.Method (Line)", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colClassMethod.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colCode.Header1' AS header WITH ;
		Alignment = 0, ;
		BackColor = 212,208,200, ;
		Caption = "Code", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colCode.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colFilename.Header1' AS header WITH ;
		Alignment = 0, ;
		Caption = "File name", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colFilename.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE AfterRowColChange
		LPARAMETERS nColIndex
		
		THISFORM.ShowDetail()
		
	ENDPROC

	PROCEDURE Init
		#include "foxref.h"
		
		DoDefault()
		
		THIS.colFilename.Header1.Caption    = GRID_FILENAME_LOC
		THIS.colClassMethod.Header1.Caption = GRID_CLASSMETHOD_LOC
		THIS.colCode.Header1.Caption        = GRID_CODE_LOC
		
		THIS.colFilename.ControlSource    = [IIF(SymbolCursor.FileID = "WINDOW", OPENWINDOW_LOC, ADDBS(SymbolCursor.Folder) + RTRIM(SymbolCursor.Filename))]
		THIS.colClassMethod.ControlSource = [THISFORM.GetClassMethodDescription()]
		THIS.colCode.ControlSource        = [THISFORM.StripTabs(SymbolCursor.Abstract)]
		
	ENDPROC

	PROCEDURE colClassMethod.Header1.Click
		THISFORM.SortBy("CLASS")
	ENDPROC

	PROCEDURE colClassMethod.Text1.DblClick
		THISFORM.GotoDef()
		
	ENDPROC

	PROCEDURE colClassMethod.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoDef()
		ENDIF
	ENDPROC

	PROCEDURE colClassMethod.Text1.RightClick
		THISFORM.ShowRightClickMenu()
	ENDPROC

	PROCEDURE colCode.Text1.DblClick
		THISFORM.GotoDef()
		
	ENDPROC

	PROCEDURE colCode.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoDef()
		ENDIF
	ENDPROC

	PROCEDURE colCode.Text1.RightClick
		THISFORM.ShowRightClickMenu()
	ENDPROC

	PROCEDURE colFilename.Header1.Click
		THISFORM.SortBy("FILENAME")
		
		
		
	ENDPROC

	PROCEDURE colFilename.Text1.DblClick
		THISFORM.GotoDef()
		
	ENDPROC

	PROCEDURE colFilename.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoDef()
		ENDIF
	ENDPROC

	PROCEDURE colFilename.Text1.RightClick
		THISFORM.ShowRightClickMenu()
	ENDPROC

ENDDEFINE

DEFINE CLASS cprogressbar AS olecontrol 
 	*< CLASSDATA: Baseclass="olecontrol" Timestamp="" Scale="Pixels" Uniqueid="" Nombre="cprogressbar" Parent="" ObjName="cprogressbar" OLEObject="E:\WINNT\System32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDZ730YtMEBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8iOgU1iYXREbFqAMDwKDYoIUM0EggAAADwHAAAwgEAAAGKq5cAAAYAHAAAAAAAAAAAAMhCAAAAAAHvzasAAAUAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTFoBRMAfACEAQAQAABYBRMAWAUTAHoAhgEAEAAASAUTAEgFEwABAACAABATADgFEwA4BRMAMAUTADAFEwB1AIsBABATAHQAjAEAEBMAGAUTABgFEwByAI4BABAAAAgFEwAIBRMAGHkXAAYANwD//////////2TwEgAf3uy9AQAFAGTwEgAAAAAAAAAAAAAAAAAAAAAAagCWAQAQAADIBBMAyAQTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGUAmwEAEAAAoAQTAKAEEwAAAAAAAAAAAGIAngEAEAAAiAQTAIgEEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	*<PropValue>
		Height = 17
		Name = "cprogressbar"
		Width = 280
	*</PropValue>

ENDDEFINE

DEFINE CLASS cprogressform AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="imgAnimation" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oProgressBar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblStatus" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblDescription" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: setdescription
		*m: setmax
		*m: setprogress
		*m: setstatus
		*m: update
		*p: lcancel
		*p: nseconds
	*</DefinedPropArrayMethod>

	*<PropValue>
		AlwaysOnTop = .T.
		AutoCenter = .T.
		Caption = "Progress"
		ControlBox = .F.
		Desktop = .T.
		DoCreate = .T.
		Height = 94
		MaxButton = .F.
		MinButton = .F.
		Name = "cprogressform"
		nseconds = 0
		Width = 378
	*</PropValue>

	ADD OBJECT 'cmdCancel' AS cfoxbutton WITH ;
		Cancel = .T., ;
		Caption = "Cancel", ;
		Left = 299, ;
		Name = "cmdCancel", ;
		Top = 55
		*< END OBJECT: ClassLib="foxctrls.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'imgAnimation' AS image WITH ;
		Height = 45, ;
		Left = 10, ;
		Name = "imgAnimation", ;
		Picture = bitmaps\findcomp.gif, ;
		Top = 5, ;
		Width = 48
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'lblDescription' AS cfoxlabel WITH ;
		Caption = "Description goes here (do not localize!)", ;
		Height = 15, ;
		Left = 80, ;
		Name = "lblDescription", ;
		Top = 20, ;
		Visible = .F., ;
		Width = 292
		*< END OBJECT: ClassLib="foxctrls.vcx" BaseClass="label" />

	ADD OBJECT 'lblStatus' AS cfoxlabel WITH ;
		Caption = "Status message goes here... (do not localize!)", ;
		Height = 15, ;
		Left = 12, ;
		Name = "lblStatus", ;
		Top = 79, ;
		Visible = .F., ;
		Width = 358
		*< END OBJECT: ClassLib="foxctrls.vcx" BaseClass="label" />

	ADD OBJECT 'oProgressBar' AS cprogressbar WITH ;
		Height = 17, ;
		Left = 10, ;
		Name = "oProgressBar", ;
		Top = 58, ;
		Width = 280
		*< END OBJECT: ClassLib="foxref.vcx" BaseClass="olecontrol" OLEObject="c:\winnt\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHBSmgQxssMBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8iOgU1iYXREbFqAMDwKDYoIUM0EggAAADwHAAAwgEAAAGKq5cAAAYAHAAAAAAAAAAAAMhCAAAAAAHvzasAAAUAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTFoBRMAfACEAQAQAABYBRMAWAUTAHoAhgEAEAAASAUTAEgFEwABAACAABATADgFEwA4BRMAMAUTADAFEwB1AIsBABATAHQAjAEAEBMAGAUTABgFEwByAI4BABAAAAgFEwAIBRMAsO8dAAYANwD//////////2TqEgAf3uy9AQAFAGTqEgAAAAAAAAAAAAAAAAAAAAAAagCWAQAQAADIBBMAyAQTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGUAmwEAEAAAoAQTAKAEEwAAAAAAAAAAAGIAngEAEAAAiAQTAIgEEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />
	
	PROCEDURE Init
		LPARAMETERS cText
		
		DoDefault()
		
		THIS.BorderStyle = 2  && fixed dialog
		
		** We check to see if a description was passed
		IF VARTYPE(m.cText) == 'C'
			THIS.SetDescription(m.cText)
		ENDIF
		
		THIS.nSeconds = SECONDS()
		
		THIS.SetStatus()
		THIS.lblStatus.Visible = .T.
		
		
	ENDPROC

	PROCEDURE setdescription
		LPARAMETERS cText
		
		IF VARTYPE(m.cText) == 'C'
			THIS.lblDescription.Caption = LEFT(m.cText, 255)
			THIS.lblDescription.Visible = .T.
		ELSE
			THIS.lblDescription.Caption = ''
		ENDIF
		
	ENDPROC

	PROCEDURE setmax
		LPARAMETERS nMax
		
		** We check to see if lnMax is numeric and if it isn't,
		** we assume it's supposed to be 100
		IF VARTYPE(m.nMax) == 'N'
			** We check to make sure nMax isn't less than the current value
			** of the progress bar, and it is, we set it to the current value
			** of the progress bar
			IF m.nMax < THIS.oProgressBar.Value
				m.nMax = THIS.oProgressBar.Value
			ELSE
				** We make sure nMax isn't smaller than 1
				IF m.nMax < 1
					m.nMax = THIS.oProgressBar.Value
				ENDIF
			ENDIF
		
			** We set the progress bar's maximum value
			THIS.oProgressBar.Max = MAX(m.nMax, 1)
		ENDIF
		
		
	ENDPROC

	PROCEDURE setprogress
		LPARAMETERS nValue, cStatusMsg
		
		** Make sure nValue is numeric and if it isn't, we set it to 0
		If VARTYPE(m.nValue) <> 'N' OR m.nValue < 0
			m.nValue = 0
		ENDIF
		
		IF VARTYPE(m.nMax) == 'N'
			IF m.nMax < 1
				m.nMax = 100
			ENDIF
			
			** We check to make sure lnValue is not greater than lnMax,
			** as that would raise an error in the progress bar itself
			IF m.nValue > m.nMax
				m.nMax = m.nValue
			ENDIF
		
			THIS.oProgressBar.Max = m.nMax
		ENDIF
		
		THIS.oProgressBar.Value = m.nValue
		
		IF VARTYPE(m.cStatusMsg) == 'C'
			THIS.SetStatus(m.cStatusMsg)
		ENDIF
		
		** to handle if the Cancel button was pressed
		DOEVENTS
		
		RETURN !THIS.lCancel
		
	ENDPROC

	PROCEDURE setstatus
		* Abstract:
		*   Set the status message.
		*
		* Parameters:
		*	[cStatusMsg]
		LPARAMETERS cStatusMsg
		
		IF VARTYPE(m.cStatusMsg) == 'C'
			THIS.lblStatus.Caption = LEFT(m.cStatusMsg, 255)
		ELSE
			THIS.lblStatus.Caption = ''
		ENDIF
	ENDPROC

	PROCEDURE update
		** We 'update' the progress of the progress bar by 1
		THIS.oProgressBar.Update()
	ENDPROC

	PROCEDURE cmdCancel.Click
		THIS.Parent.lCancel = .T.
	ENDPROC

ENDDEFINE

DEFINE CLASS cresultsallgrid AS cfoxgrid OF "foxctrls.vcx" 
 	*< CLASSDATA: Baseclass="grid" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="colFilename.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colFilename.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colClassMethod.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colClassMethod.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colCode.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colCode.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colCheckbox.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colCheckbox.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colCheckbox.chkSelected" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colSymbol.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colSymbol.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colMethod.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colMethod.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colLine.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="colLine.Text1" UniqueID="" Timestamp="" />

	*<PropValue>
		AllowHeaderSizing = .F.
		AllowRowSizing = .F.
		ColumnCount = 7
		DeleteMark = .F.
		FontName = "Tahoma"
		FontSize = 8
		GridLineColor = 192,192,192
		GridLines = 2
		HeaderHeight = 18
		Height = 383
		LockColumns = 1
		Name = "cresultsallgrid"
		ReadOnly = .T.
		RecordMark = .F.
		RecordSource = "FoxRefCursor"
		RowHeight = 18
		ScrollBars = 3
		SplitBar = .F.
		Width = 818
		Column1.Alignment = 0
		Column1.ColumnOrder = 3
		Column1.ControlSource = ""
		Column1.DynamicBackColor = ""
		Column1.Enabled = .T.
		Column1.FontBold = .F.
		Column1.FontName = "Tahoma"
		Column1.FontSize = 8
		Column1.Name = "colFilename"
		Column1.ReadOnly = .T.
		Column1.Width = 237
		Column2.Alignment = 0
		Column2.ColumnOrder = 4
		Column2.ControlSource = ""
		Column2.DynamicBackColor = ""
		Column2.Enabled = .T.
		Column2.FontBold = .F.
		Column2.FontName = "Tahoma"
		Column2.FontSize = 8
		Column2.Name = "colClassMethod"
		Column2.ReadOnly = .T.
		Column2.Width = 182
		Column3.Alignment = 0
		Column3.ColumnOrder = 7
		Column3.ControlSource = ""
		Column3.Enabled = .T.
		Column3.FontBold = .F.
		Column3.FontName = "Tahoma"
		Column3.FontSize = 8
		Column3.Name = "colCode"
		Column3.ReadOnly = .T.
		Column3.Width = 600
		Column4.Alignment = 2
		Column4.BackColor = 255,255,255
		Column4.ColumnOrder = 1
		Column4.CurrentControl = "chkSelected"
		Column4.DynamicCurrentControl = ""
		Column4.Enabled = .T.
		Column4.FontName = "Tahoma"
		Column4.FontSize = 8
		Column4.ForeColor = 0,0,0
		Column4.Name = "colCheckbox"
		Column4.ReadOnly = .F.
		Column4.Resizable = .F.
		Column4.Sparse = .F.
		Column4.Width = 22
		Column5.Alignment = 2
		Column5.BackColor = 255,255,255
		Column5.ColumnOrder = 2
		Column5.Enabled = .T.
		Column5.FontName = "Wingdings"
		Column5.FontSize = 10
		Column5.ForeColor = 0,0,0
		Column5.Name = "colSymbol"
		Column5.ReadOnly = .T.
		Column5.Resizable = .F.
		Column5.Width = 15
		Column6.Alignment = 0
		Column6.ColumnOrder = 5
		Column6.FontName = "Tahoma"
		Column6.FontSize = 8
		Column6.Name = "colMethod"
		Column6.ReadOnly = .T.
		Column6.Width = 90
		Column7.Alignment = 1
		Column7.ColumnOrder = 6
		Column7.FontName = "Tahoma"
		Column7.FontSize = 8
		Column7.Name = "colLine"
		Column7.ReadOnly = .T.
		Column7.Width = 50
	*</PropValue>

	ADD OBJECT 'colCheckbox.chkSelected' AS cfoxcheckbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		Caption = "", ;
		Centered = .T., ;
		Enabled = .T., ;
		ForeColor = 0,0,0, ;
		Left = 35, ;
		Name = "chkSelected", ;
		ReadOnly = .F., ;
		SpecialEffect = 1, ;
		Top = 35
		*< END OBJECT: ClassLib="foxctrls.vcx" BaseClass="checkbox" />

	ADD OBJECT 'colCheckbox.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Checkbox", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1", ;
		Picture = bitmaps\check.bmp
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colCheckbox.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colClassMethod.Header1' AS header WITH ;
		Alignment = 0, ;
		Caption = "Class.Method, Line", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colClassMethod.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colCode.Header1' AS header WITH ;
		Alignment = 0, ;
		Caption = "Code", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colCode.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colFilename.Header1' AS header WITH ;
		Alignment = 0, ;
		Caption = "File name", ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colFilename.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontBold = .F., ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colLine.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Line", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colLine.Text1' AS textbox WITH ;
		Alignment = 1, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colMethod.Header1' AS header WITH ;
		Caption = "Method", ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colMethod.Text1' AS textbox WITH ;
		Alignment = 0, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'colSymbol.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "#", ;
		FontCharSet = 0, ;
		FontName = "Tahoma", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'colSymbol.Text1' AS textbox WITH ;
		Alignment = 2, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontName = "Wingdings", ;
		FontSize = 10, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F.
		*< END OBJECT: BaseClass="textbox" />
	
	PROCEDURE AfterRowColChange
		LPARAMETERS nColIndex
		
		THISFORM.ShowDetail()
		
	ENDPROC

	PROCEDURE Init
		#include "foxref.h"
		
		DoDefault()
		
		THIS.colCheckbox.DynamicCurrentControl = [IIF(ISNULL(FoxRefCursor.Checked), "Text1", "chkSelected")]
		
		THIS.colSymbol.Header1.Caption      = '#'
		THIS.colCheckbox.Header1.Caption    = ''  && checkbox column
		THIS.colFilename.Header1.Caption    = GRID_FILENAME_LOC
		THIS.colClassMethod.Header1.Caption = GRID_CLASSMETHOD_LOC
		THIS.colCode.Header1.Caption        = GRID_CODE_LOC
		
		THIS.colSymbol.ControlSource      = [IIF(FoxRefCursor.RefCnt > 1, CHR(128 + MIN(FoxRefCursor.RefCnt, 9)), '')]
		THIS.colCheckbox.ControlSource    = [FoxRefCursor.Checked]
		THIS.colFilename.ControlSource    = [ADDBS(FoxRefCursor.Folder) + RTRIM(FoxRefCursor.Filename)]
		THIS.colClassMethod.ControlSource = [THISFORM.GetClassMethodDescription(THISFORM.lShowDistinctMethodLine)]
		THIS.colMethod.ControlSource      = [IIF('.' $ FoxRefCursor.ProcName, JUSTEXT(FoxRefCursor.ProcName), FoxRefCursor.ProcName)]
		* THIS.colLine.ControlSource        = [IIF(INLIST(FoxRefCursor.FindType, FINDTYPE_NAME, FINDTYPE_PROPERTYNAME, FINDTYPE_PROPERTYVALUE, FINDTYPE_EXPR, FINDTYPE_OTHER), '', LTRIM(STR(FoxRefCursor.ProcLineNo, 8, 0)))]
		THIS.colLine.ControlSource        = [IIF(FoxRefCursor.ProcLineNo == 0, '', LTRIM(STR(FoxRefCursor.ProcLineNo, 8, 0)))]
		THIS.colCode.ControlSource        = [THISFORM.StripTabs(FoxRefCursor.Abstract)]
		
		
	ENDPROC

	PROCEDURE colCheckbox.chkSelected.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoReference()
		ELSE
			DoDefault(nKeyCode, nShiftAltCtrl)
		ENDIF
		
		
	ENDPROC

	PROCEDURE colCheckbox.Header1.Click
		THISFORM.OnSortBy("CHECKED")
		
	ENDPROC

	PROCEDURE colCheckbox.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoReference()
		ELSE
			DoDefault(nKeyCode, nShiftAltCtrl)
		ENDIF
		
		
	ENDPROC

	PROCEDURE colClassMethod.Header1.Click
		THISFORM.OnSortBy("CLASS")
	ENDPROC

	PROCEDURE colClassMethod.Text1.DblClick
		THISFORM.GotoReference()
		
	ENDPROC

	PROCEDURE colClassMethod.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoReference()
		ELSE
			DoDefault(nKeyCode, nShiftAltCtrl)
		ENDIF
		
		
	ENDPROC

	PROCEDURE colClassMethod.Text1.RightClick
		THISFORM.ResultsRightClickMenu()
	ENDPROC

	PROCEDURE colCode.Text1.DblClick
		THISFORM.GotoReference()
		
	ENDPROC

	PROCEDURE colCode.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoReference()
		ELSE
			DoDefault(nKeyCode, nShiftAltCtrl)
		ENDIF
		
		
	ENDPROC

	PROCEDURE colCode.Text1.RightClick
		THISFORM.ResultsRightClickMenu()
	ENDPROC

	PROCEDURE colFilename.Header1.Click
		THISFORM.OnSortBy("FILENAME")
		
		
		
	ENDPROC

	PROCEDURE colFilename.Text1.DblClick
		THISFORM.GotoReference()
		
	ENDPROC

	PROCEDURE colFilename.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoReference()
		ELSE
			DoDefault(nKeyCode, nShiftAltCtrl)
		ENDIF
		
		
	ENDPROC

	PROCEDURE colFilename.Text1.RightClick
		THISFORM.ResultsRightClickMenu()
	ENDPROC

	PROCEDURE colLine.Header1.Click
		THISFORM.OnSortBy("LINENO")
		
		
		
	ENDPROC

	PROCEDURE colLine.Text1.DblClick
		THISFORM.GotoReference()
	ENDPROC

	PROCEDURE colLine.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoReference()
		ELSE
			DoDefault(nKeyCode, nShiftAltCtrl)
		ENDIF
		
		
	ENDPROC

	PROCEDURE colLine.Text1.RightClick
		THISFORM.ResultsRightClickMenu()
	ENDPROC

	PROCEDURE colMethod.Header1.Click
		THISFORM.OnSortBy("METHOD")
		
	ENDPROC

	PROCEDURE colMethod.Text1.DblClick
		THISFORM.GotoReference()
	ENDPROC

	PROCEDURE colMethod.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		IF nKeyCode == 13
			NODEFAULT
			THISFORM.GotoReference()
		ELSE
			DoDefault(nKeyCode, nShiftAltCtrl)
		ENDIF
		
		
	ENDPROC

	PROCEDURE colMethod.Text1.RightClick
		THISFORM.ResultsRightClickMenu()
	ENDPROC

ENDDEFINE

DEFINE CLASS cwebbrowser AS olecontrol 
 	*< CLASSDATA: Baseclass="olecontrol" Timestamp="" Scale="Pixels" Uniqueid="" Nombre="cwebbrowser" Parent="" ObjName="cwebbrowser" OLEObject="C:\WINNT\System32\shdocvw.dll" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDLPVpGssMBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4AAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAAAAAAAwAAAP7////+////BAAAAP7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9h+VaICjTQEalrAMBP1wWiTAAAAFYKAABWCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAOAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkAGQAZQBkAAEAAIBvAG8AbABzAFwARQBWAEIAXABkAGUAdgBjAHQAcgBsAHMAXABtAHMAYwBlAHQAYQBiAHMAdAByAGkAcAABAAAA4NBXAHM1zxGuaQgAKy4SYggAAAAAAAAATAAAAAEUAgAAAAAAwAAAAAAAAEaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAA5ADkAMAAwADAAQwB9ACAARQA6AFwAVwBJAE4ATgBUAFwAUwB5AHMAdABlAG0AMwAyAFwAQwBGAEYASQBMAEUAfgAxAC4ARABMAEwAAABDAEYAUwBvAHUAcgBjAGUAQwBvAG4AdAByAG8AbAAgAEMAbwBuAHQAcgBvAGwACQB7ADEAMgA4ADgAMwA0AEEAMQAtADIANgA0ADYALQAxADEARAAxAC0AOQA0ADkAOQAtADAAMABBADAAMgA0ADcAOAAzADUARAA3AH0AIABFADoAXABXAA==" />

	*<DefinedPropArrayMethod>
		*m: getfonttag		&& Add font to tag.
		*m: htmlencode
		*m: write
		*p: cfontface
		*p: nbackcolor
		*p: nfontsize
	*</DefinedPropArrayMethod>

	*<PropValue>
		cfontface = Tahoma
		Height = 100
		Name = "cwebbrowser"
		nbackcolor = 16777215
		nfontsize = 11
		Width = 100
	*</PropValue>
	
	PROCEDURE BeforeNavigate2
		*** ActiveX Control Event ***
		LPARAMETERS pdisp, url, flags, targetframename, postdata, headers, cancel
		
		IF url = "vfps://"
			Cancel = .T.
		
			url = lower(url)
			DO CASE
			CASE url="vfps://close/"
				THISFORM.Release()
			OTHERWISE
			ENDCASE
		ENDIF
		
	ENDPROC

	PROCEDURE getfonttag		&& Add font to tag.
		RETURN [<font style="FONT-SIZE: ]+TRANSFORM(INT(THIS.nFontSize))+[px; FONT-FAMILY: ] + THIS.cFontFace + [; FONT-STYLE: normal">]
		
	ENDPROC

	PROCEDURE htmlencode
		LPARAMETERS cHTML
		
		*!*	cHTML = STRTRAN(cHTML, '&', "&amp;")
		*!*	cHTML = STRTRAN(cHTML, '<', "&lt;")
		*!*	cHTML = STRTRAN(cHTML, '>', "&gt;")
		
		RETURN cHTML
		
		
		
	ENDPROC

	PROCEDURE Init
		THIS.Navigate("about:blank")
	ENDPROC

	PROCEDURE Refresh
		*** ActiveX Control Method ***
		NODEFAULT
		
	ENDPROC

	PROCEDURE write
		LPARAMETERS cHTML
		LOCAL cBGColor
		LOCAL cScript
		
		cHTML = STRTRAN(cHTML,CHR(0),'')
		
		IF NOT "<body" $ LOWER(cHTML)
			cBGColor = RIGHT(TRANSFORM(THIS.nBackColor,"@0"),6)
			cBGColor = [#] + SUBSTR(cBGColor,5,2) + SUBSTR(cBGColor,3,2) + SUBSTR(cBGColor,1,2)
		
			TEXT TO cScript NOSHOW PRETEXT ' '
				<SCRIPT ID=clientEventHandlersJS LANGUAGE=javascript>
				document.oncontextmenu = 
				function document_oncontextmenu() {return false;};
		
				document.onkeypress = 
				function (evt) {
				  if (event.keyCode == 27)
				    location.href = "vfps://close/";
		
				  return true;
				};
		
				</SCRIPT>
			ENDTEXT
			cHTML = [<html><head>] + cScript + [</head><body bgcolor="] + cBGColor + [" scroll="auto"><font style="FONT-SIZE: ]+TRANSFORM(INT(THIS.nFontSize))+[px; FONT-FAMILY: ] + THIS.cFontFace + [; FONT-STYLE: normal">] + cHTML + [</font></body></html>]
		ENDIF
		
		DO WHILE NOT VARTYPE(THIS.Document) = "O"
		ENDDO
		
		THIS.Document.Open()
		THIS.Document.Write(cHTML)
		THIS.Document.Close()
		
		THIS.Document.body.topmargin = 1
		THIS.Document.body.leftmargin = 3
		
		RETURN .T.
	ENDPROC

ENDDEFINE

DEFINE CLASS scriptengine AS custom 
 	*< CLASSDATA: Baseclass="custom" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*p: foxref
	*</DefinedPropArrayMethod>

	PROTECTED AddObject,AddProperty,BaseClass,ClassLibrary,CloneObject,Comment,ControlCount,Controls,Error,Height,HelpContextID,NewObject,Objects,Picture,ReadExpression,ReadMethod,RemoveObject,ResetToDefault,SaveAsClass,ShowWhatsThis,Tag,WhatsThisHelpID,Width,WriteExpression,WriteMethod
	*<PropValue>
		foxref = .NULL.
		Name = "scriptengine"
	*</PropValue>
	
	PROCEDURE Init
		THIS.FoxRef = NEWOBJECT("FoxRef", "FoxRefEngine.prg")
	ENDPROC

ENDDEFINE
